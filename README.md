# Анализ данных и построение моделей предсказания стоимости авто

## Часть 1

В рамках задания был выполнен начальный анализ данных (EDA), обработка признаков и построение дашбордов с использованием библиотеки `ydata-profiling`.

### Основные этапы обработки данных:
- Заполнение пропусков в столбцах медианными значениями.
- Удаление дубликатов.
- Обновление индексов.
- Приведение столбцов `mileage`, `engine` и `max_power` к типу `float`.
- Удаление столбца `torque`.
- Приведение столбцов `engine` и `seats` к типу `int`.
- Проведен анализ основных статистик числовых и категориальных признаков.

### Визуализация:
- Построены графики зависимостей всех числовых признаков.
- Распределения для `train` и `test` визуально схожи.

### Предположения:
1. Стоимость (`selling_price`) может зависеть от квадрата возраста машины (`year`).
2. Наблюдается зависимость стоимости от объема двигателя (`engine`), возможно линейная.
3. Зависимость стоимости от мощности двигателя (`max_power`), вероятно линейная.

### Корреляционный анализ:
- Вычислены коэффициенты корреляции Пирсона и построена тепловая карта.
- `engine` и `year` практически не связаны (корреляция близка к нулю).
- Сильная положительная зависимость наблюдается между `max_power` и `selling_price`.
- Коэффициент корреляции между `year` и `km_driven` равен -0.37, что указывает на обратную зависимость: чем старше автомобиль, тем больше он проехал.

---

## Часть 2

### Шаги:
1. Датасет разделен на `X_train`, `y_train`, `X_test`, `y_test`.
2. Обучена линейная регрессия с параметрами по умолчанию.
3. Рассчитаны метрики:
   - **MSE**: тест — `233,551,443,099.40`, трейн — `117,090,306,033.02`.
   - **R²**: тест — `0.5937`, трейн — `0.5915`.
4. Разница между MSE для `train` и `test` ожидаема. Высокая R² (~0.59) указывает на хорошую степень соответствия модели данным.

### Стандартизация признаков:
После стандартизации:
- **MSE** снизилось, **R²** немного увеличилось. Самый значимый признак — `max_power`.

### Регуляризация (Lasso):
- Обучение модели с Lasso-регрессией показало ухудшение метрик. Коэффициенты практически не изменились, что указывает на слабое влияние регуляризации.

### Оптимизация гиперпараметров:
- GridSearchCV показал, что лучший параметр `alpha` для Lasso равен `10`. Однако метрики изменились незначительно.

### ElasticNet:
- Лучшие параметры: `alpha = 0.5`, `l1_ratio = 0.8`. Модель показала аналогичные результаты.

---

## Часть 3

Категориальные признаки закодированы методом OneHot. Для устранения несоответствий в размерах `X_train` и `X_test` добавлены отсутствующие столбцы в тестовый набор данных. После обработки обучена модель Ridge:

- Лучший параметр: `alpha = 10`.
- **MSE**: тест — `206,106,535,502.08`, трейн — `99,402,746,944.13`.
- **R²**: тест — `0.6414`, трейн — `0.6532`.

После кодирования категориальных признаков модель Ridge показала значительное улучшение (снижение ошибки ~10%).

---

## Часть 4

Оценка бизнес-метрики: доля прогнозов с отклонением от реальных цен не более чем на 10%.

### Результаты:
- **Linear Regression**: 22.5%.
- **Lasso**: 22.5%.
- **Ridge**: 24.7%.

Наибольшую точность показала модель Ridge.

---

## Итог:
В ходе работы были обработаны данные и обучены несколько моделей для предсказания стоимости автомобиля. Ridge-регрессия продемонстрировала наилучшие результаты после включения категориальных признаков, снизив ошибку на 10%.
